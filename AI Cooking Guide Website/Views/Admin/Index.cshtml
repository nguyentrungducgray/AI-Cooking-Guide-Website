﻿@{
	Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Boxicons -->
	<link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet">
	<!-- My CSS -->
	<link href="~/css/admin.css" rel="stylesheet" />

	<title>AdminHub</title>
</head>
<body>

	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<img src="~/img/logo/logo.png" alt="Logo AdminHub" class="icon" />
			<span class="text">Michelin Btec</span>
		</a>

		<ul class="side-menu top">
			<li class="active">
				<a href="#">
					<i class='bx bxs-dashboard'></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="#">
					<i class='bx bxs-shopping-bag-alt'></i>
					<span class="text">My Store</span>
				</a>
			</li>
			<li>
				<a href="#">
					<i class='bx bxs-doughnut-chart'></i>
					<span class="text">Analytics</span>
				</a>
			</li>
			<li>
				<a href="#">
					<i class='bx bxs-message-dots'></i>
					<span class="text">Message</span>
				</a>
			</li>
			<li>
				<a href="#">
					<i class='bx bxs-group'></i>
					<span class="text">Team</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li>
				<a href="#">
					<i class='bx bxs-cog'></i>
					<span class="text">Settings</span>
				</a>
			</li>
			<li>
				<a href="#" class="logout">
					<i class='bx bxs-log-out-circle'></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->
	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu'></i>
			<a href="#" class="nav-link">Categories</a>
			<form action="#">
				<div class="form-input">
					<input type="search" placeholder="Search...">
					<button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
				</div>
			</form>
			<input type="checkbox" id="switch-mode" hidden>

			<a href="#" class="notification">
				<i class='bx bxs-bell'></i>
				<span class="num">8</span>
			</a>
			<a href="#" class="profile">
				<img src="<%= ResolveUrl(" ~ /img/people.png") %>" alt="User Profile">
			</a>
		</nav>
		<!-- NAVBAR -->
		<!-- MAIN -->
		<main>
			<div class="head-title">
				<div class="left">
					<h1>Dashboard</h1>
					<ul class="breadcrumb">
						<li>
							<a href="#">Dashboard</a>
						</li>
						<li><i class='bx bx-chevron-right'></i></li>
						<li>
							<a class="active" href="#">Home</a>
						</li>
					</ul>
				</div>
				<a href="#" class="btn-download">
					<i class='bx bxs-cloud-download'></i>
					<span class="text">Download PDF</span>
				</a>
			</div>
			<!DOCTYPE html>
			<html lang="en">
			<head>
				<meta charset="UTF-8">
				<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<title>Thêm Món Ăn</title>
				<link rel="stylesheet" href="styles.css"> <!-- Liên kết đến file CSS -->
			</head>
			<body>
				<div class="form-container">
					<h2>Thêm Món Ăn</h2>
					<form id="recipe-form" onsubmit="saveRecipe(event)">
						<label for="name">Tên Món Ăn:</label>
						<input type="text" id="name" required>

						<label for="ingredients">Nguyên Liệu:</label>
						<div id="ingredients-container">
							<input type="text" name="ingredients" class="ingredient" required>
						</div>
						<button type="button" onclick="addIngredient()">Thêm Nguyên Liệu</button>

						<label for="description">Mô Tả:</label>
						<input type="text" id="description" required>

						<label for="steps">Các Bước Nấu:</label>
						<div id="steps-container">
							<input type="text" name="steps" class="step" required>
						</div>
						<button type="button" onclick="addStep()">Thêm Bước Nấu</button>



						<label for="image">Chọn Ảnh:</label>
						<input type="file" id="image" name="Image" accept="image/*" required onchange="previewImage(event)">
						<img id="imagePreview" style="display: none; max-width: 100%; margin-top: 10px;" alt="Image Preview" />

					</form>
				</div>

				<div id="recipe-list"></div>

				<script>
					function previewImage(event) {
						const imagePreview = document.getElementById('imagePreview');
						const file = event.target.files[0]; // Lấy tệp đầu tiên từ danh sách tệp

						if (file) {
							const reader = new FileReader();

							reader.onload = function (e) {
								imagePreview.src = e.target.result; // Gán URL tạm thời cho thẻ img
								imagePreview.style.display = 'block'; // Hiển thị thẻ img
							}

							reader.readAsDataURL(file); // Đọc tệp dưới dạng URL
						} else {
							imagePreview.src = ""; // Nếu không có tệp, xóa src
							imagePreview.style.display = 'none'; // Ẩn thẻ img
						}
					}
					document.getElementById('image').addEventListener('change', previewImage);


					function addIngredient() {
						const ingredientsContainer = document.getElementById('ingredients-container');
						const input = document.createElement('input');
						input.type = 'text';
						input.name = 'ingredients';
						input.className = 'ingredient';
						ingredientsContainer.appendChild(input);
					}

					function addStep() {
						const stepsContainer = document.getElementById('steps-container');
						const input = document.createElement('input');
						input.type = 'text';
						input.name = 'steps';
						input.className = 'step';
						stepsContainer.appendChild(input);
					}

					async function saveRecipe(event) {
						event.preventDefault(); // Ngăn chặn form gửi mặc định
						const formData = new FormData(document.getElementById("recipe-form"));

						// Lấy giá trị từ các trường input
						const name = document.getElementById('name').value;
						const description = document.getElementById('description').value;

						// Lấy danh sách nguyên liệu và bước nấu từ các trường input
						const ingredients = Array.from(document.getElementsByClassName('ingredient')).map(input => input.value);
						const steps = Array.from(document.getElementsByClassName('step')).map(input => input.value);

						// Thêm name và description vào formData
						formData.append('Name', name);
						formData.append('Description', description);
						formData.append('Ingredients', JSON.stringify(ingredients)); // Chuyển đổi thành chuỗi JSON
						formData.append('Steps', JSON.stringify(steps)); // Chuyển đổi thành chuỗi JSON

						const response = await fetch('https://localhost:7149/Admin/SaveRecipe', {
							method: 'POST',
							body: formData
						});

						if (response.ok) {
							alert("Thêm món ăn thành công!");
							const recipe = await response.json(); // Nếu server trả về thông tin món ăn
							displayRecipe(recipe); // Hiển thị món ăn mới
						} else {
							const errorMessage = await response.text();
							alert("Không thể lưu món ăn: " + errorMessage);
						}
					}

				</script>


				<style>
					.hidden {
						display: none;
					}

					/* Các CSS khác ở đây (nếu cần) */
				</style>

			</body>
		</html>


	</main>
	<!-- MAIN -->
</section>
<!-- CONTENT -->

<script src="~/js/admin.js"></script>
</body>
</html>